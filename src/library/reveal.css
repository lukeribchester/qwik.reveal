@layer reveal {
    /* Keyframes */
    @keyframes reveal-fade-up {
        from {
            opacity: var(--reveal-opacity, 0);
            translate: var(--reveal-x, 0) var(--reveal-y, 4rem);
            filter: blur(var(--reveal-blur, 0));
        }
        to {
            opacity: 1;
            translate: 0 0;
            filter: blur(0);
        }
    }

    /* Presets */
    .reveal-range--very-early {
        --reveal-range-start: 0%;
        --reveal-range-end: 15%;

        --reveal-stagger-start-min: 0%;
        --reveal-stagger-start-max: 10%;
        --reveal-stagger-end-min: 15%;
        --reveal-stagger-end-max: 40%;
    }

    .reveal-range--early {
        --reveal-range-start: 0%;
        --reveal-range-end: 20%;

        --reveal-stagger-start-min: 0%;
        --reveal-stagger-start-max: 15%;
        --reveal-stagger-end-min: 20%;
        --reveal-stagger-end-max: 50%;
    }

    .reveal-range--mid {
        --reveal-range-start: 0%;
        --reveal-range-end: 30%;

        --reveal-stagger-start-min: 0%;
        --reveal-stagger-start-max: 20%;
        --reveal-stagger-end-min: 30%;
        --reveal-stagger-end-max: 60%;
    }

    .reveal-range--late {
        --reveal-range-start: 10%;
        --reveal-range-end: 40%;

        --reveal-stagger-start-min: 10%;
        --reveal-stagger-start-max: 30%;
        --reveal-stagger-end-min: 40%;
        --reveal-stagger-end-max: 70%;
    }

    .reveal-range--very-late {
        --reveal-range-start: 20%;
        --reveal-range-end: 55%;

        --reveal-stagger-start-min: 20%;
        --reveal-stagger-start-max: 40%;
        --reveal-stagger-end-min: 55%;
        --reveal-stagger-end-max: 85%;
    }

    .reveal-from--left {
        --reveal-x: -100vw;
        --reveal-y: 0;
    }

    .reveal-from--right {
        --reveal-x: 100vw;
        --reveal-y: 0;
    }

    .reveal-from--top {
        --reveal-x: 0;
        --reveal-y: -100vh;
    }

    .reveal-from--bottom {
        --reveal-x: 0;
        --reveal-y: 100vh;
    }

    /* Presets (Screens) */
    .reveal-screen .reveal-range--very-early,
    .reveal-screen .reveal-range--early,
    .reveal-screen .reveal-range--mid,
    .reveal-screen .reveal-range--late,
    .reveal-screen .reveal-range--very-late {
        --reveal-stagger-end-min: 0%;
        --reveal-stagger-end-max: 0%;
    }

    /* Time-Driven Animations */
    :where([data-reveal-driver="time"]) {
        will-change: opacity, translate, filter;
    }

    :where([data-reveal-driver="time"][data-reveal="pending"]) {
        opacity: var(--reveal-opacity, 0);
        translate: var(--reveal-x, 0) var(--reveal-y, 4rem);
        filter: blur(var(--reveal-blur, 0));
    }

    :where([data-reveal-driver="time"][data-reveal="shown"]) {
        opacity: 1;
        translate: 0 0;
        filter: blur(0);
        animation: none;
    }

    :where([data-reveal-driver="time"][data-reveal="revealed"]) {
        animation-name: reveal-fade-up;
        animation-duration: var(--reveal-duration, 500ms);
        animation-timing-function: var(--reveal-ease, cubic-bezier(.2, .8, .2, 1));
        animation-fill-mode: both;

        /* Single target delay & group staggering */
        animation-delay: calc(var(--reveal-i, 1) * var(--reveal-delay-step, 100ms));
    }

    /* Scroll-Driven Animations */
    @supports (animation-timeline: view()) {
        /* A .reveal-screen defines a named view-timeline (with a linked scroll-timeline) */
        .reveal-screen {
            /* Named view-timeline */
            view-timeline-name: --screen;
            view-timeline-axis: block;
            view-timeline-inset: var(--reveal-screen-inset, 0 0);

            /* Linked scroll-timeline */
            --reveal-scroll-timeline: --screen;

            /* Default range modes (start/end) */
            --reveal-range-start-name: cover;
            --reveal-range-end-name: contain;

            /* Default range values (start/end) */
            --reveal-range-start-default: 20%;
            --reveal-range-end-default: 40%;

            --reveal-stagger-start-min-default: 20%;
            --reveal-stagger-start-max-default: 40%;
            --reveal-stagger-end-min-default: 80%;
            --reveal-stagger-end-max-default: 100%;
        }

        /* Scroll-timeline scope overrides
         * Usage: Apply per target (single or group).
         */
        .reveal-scope--view {
            /* Linked scroll-timeline (view) */
            --reveal-scroll-timeline: var(--reveal-view-timeline, view(block 0 0));

            /* Default range modes (start/end) */
            --reveal-range-start-name: cover;
            --reveal-range-end-name: cover;

            /* Default range values (start/end) */
            --reveal-range-start-default: 0%;
            --reveal-range-end-default: 30%;

            --reveal-stagger-start-min-default: 0%;
            --reveal-stagger-start-max-default: 20%;
            --reveal-stagger-end-min-default: 30%;
            --reveal-stagger-end-max-default: 60%;
        }

        .reveal-scope--screen {
            /* Linked scroll-timeline (nearest .reveal-screen) */
            --reveal-scroll-timeline: --screen;

            /* Default range modes (start/end) */
            --reveal-range-start-name: cover;
            --reveal-range-end-name: contain;

            /* Default range values (start/end) */
            --reveal-range-start-default: 0%;
            --reveal-range-end-default: 30%;

            --reveal-stagger-start-min-default: 0%;
            --reveal-stagger-start-max-default: 20%;
            --reveal-stagger-end-min-default: 0%;
            --reveal-stagger-end-max-default: 0%;
        }

        /* Scroll-driven target (single) */
        :where(.reveal):not(.reveal--time) {
            opacity: var(--reveal-opacity, 0);
            translate: var(--reveal-x, 0) var(--reveal-y, 4rem);
            filter: blur(var(--reveal-blur, 0));

            animation-name: reveal-fade-up;
            animation-duration: var(--reveal-duration, 500ms);
            animation-timing-function: var(--reveal-scroll-ease, var(--reveal-ease, cubic-bezier(.2, .8, .2, 1)));
            animation-fill-mode: both;

            animation-timeline: var(--reveal-scroll-timeline, var(--reveal-view-timeline, view(block 0 0)));

            animation-range: var(--reveal-range-start-name, cover) var(--reveal-range-start, var(--reveal-range-start-default, 0%)) var(--reveal-range-end-name, cover) var(--reveal-range-end, var(--reveal-range-end-default, 30%));

            will-change: opacity, translate, filter;
        }

        /* Scroll-driven target (group) */
        :where(.reveal-group):not(.reveal--time) > :where(*):not(.reveal-ignore):not(.reveal--time) {
            opacity: var(--reveal-opacity, 0);
            translate: var(--reveal-x, 0) var(--reveal-y, 4rem);
            filter: blur(var(--reveal-blur, 0));

            animation-name: reveal-fade-up;
            animation-duration: var(--reveal-duration, 500ms);
            animation-timing-function: var(--reveal-scroll-ease, var(--reveal-ease, cubic-bezier(.2, .8, .2, 1)));
            animation-fill-mode: both;

            animation-timeline: var(--reveal-scroll-timeline, var(--reveal-view-timeline, view(block 0 0)));

            animation-range: var(--reveal-range-start-name, cover) var(--reveal-range-start, var(--reveal-range-start-default, 0%)) var(--reveal-range-end-name, cover) var(--reveal-range-end, var(--reveal-range-end-default, 30%));

            will-change: opacity, translate, filter;
        }

        /* Scroll-driven target (staggered group)
         * Behaviour: Staggers group elements with a delay based on their index.
         */
        :where(.reveal-group.reveal-stagger):not(.reveal--time) > :where(*):not(.reveal-ignore):not(.reveal--time) {
            animation-range: var(--reveal-range-start-name, cover) clamp(
                    0%,
                    calc(
                            var(--reveal-stagger-start-min, var(--reveal-stagger-start-min-default, 0%)) +
                            (var(--reveal-i, 0) *
                            (var(--reveal-stagger-start-max, var(--reveal-stagger-start-max-default, 20%)) - var(--reveal-stagger-start-min, var(--reveal-stagger-start-min-default, 0%))) /
                            var(--reveal-stagger-last, 1))
                    ),
                    100%
            ) var(--reveal-range-end-name, cover) clamp(
                    0%,
                    calc(
                            var(--reveal-stagger-end-min, var(--reveal-stagger-end-min-default, 30%)) +
                            (var(--reveal-i, 0) *
                            (var(--reveal-stagger-end-max, var(--reveal-stagger-end-max-default, 60%)) - var(--reveal-stagger-end-min, var(--reveal-stagger-end-min-default, 30%))) /
                            var(--reveal-stagger-last, 1))
                    ),
                    100%
            );
        }

        /* Scroll-driven target (staggered grid)
         * Behaviour: Animates grid elements based on:
         *            - row/column (view-scoped);
         *            - whole grid (screen-scoped).
         */
        :where(.reveal-group.reveal-stagger.grid):not(.reveal--time) {
            --reveal-stagger-start-max: var(--reveal-stagger-start-min, var(--reveal-stagger-start-min-default, 0%));
            --reveal-stagger-end-max: var(--reveal-stagger-end-min, var(--reveal-stagger-end-min-default, 30%));
        }
    }

    /* Reduced Motion */
    @media (prefers-reduced-motion: reduce) {
        :where(.reveal),
        :where(.reveal-group) > :where(*),
        :where([data-reveal-driver="time"]) {
            animation: none !important;
            opacity: 1 !important;
            translate: 0 0 !important;
            filter: blur(0) !important;
        }
    }
}
